https://www.interviewquery.com/questions/upsell-transactions

SQL:

WITH CTE AS
(SELECT
USER_ID, CREATED_AT, PRODUCT_ID, QUANTITY,
DENSE_RANK() OVER(PARTITION BY USER_ID ORDER BY CREATED_AT) RANKK
FROM TRANSACTIONS
ORDER BY 1, 2)

SELECT COUNT(DISTINCT USER_ID) NUM_OF_UPSOLD_CUSTOMERS
FROM CTE
WHERE RANKK > 1


PYTHON:

