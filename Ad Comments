https://www.interviewquery.com/questions/ad-comments

SQL:

WITH FEED_COMMENTS AS 
(SELECT AD_ID, COUNT(DISTINCT COMMENT_ID) AS FEED_COMMENTS FROM FEED_COMMENTS GROUP BY 1), 

MOMENTS_COMMENTS AS 
(SELECT AD_ID, COUNT(DISTINCT COMMENT_ID) AS MOMENTS_COMMENTS FROM MOMENTS_COMMENTS GROUP BY 1)

SELECT 
A.NAME AS NAME, 
1.0*FC.FEED_COMMENTS/(FC.FEED_COMMENTS+MC.MOMENTS_COMMENTS) AS PERCENTAGE_FEED,
1.0*MC.MOMENTS_COMMENTS/(FC.FEED_COMMENTS+MC.MOMENTS_COMMENTS) AS PERCENTAGE_MOMENTS
FROM ADS A 
JOIN FEED_COMMENTS FC ON FC.AD_ID = A.ID 
JOIN MOMENTS_COMMENTS MC ON MC.AD_ID = A.ID


PYTHON:
