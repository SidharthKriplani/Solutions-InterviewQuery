https://www.interviewquery.com/questions/liked-and-commented

SQL:

WITH CTE AS (
SELECT
U.id AS user_id, U.name AS user_name, U.created_at AS user_created_at,
E.action AS event_action, E.created_at AS event_created_at
FROM users U
JOIN events E
ON E.user_id = U.id),

likers_commenters AS (
SELECT DISTINCT user_id
FROM CTE
WHERE event_action IN ('like', 'comment'))

SELECT 1.0*COUNT(DISTINCT user_id)/(SELECT COUNT(DISTINCT user_id) FROM CTE)
FROM CTE
WHERE user_id NOT IN (SELECT user_id FROM likers_commenters)


PYTHON:

