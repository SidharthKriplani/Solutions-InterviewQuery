https://www.interviewquery.com/questions/seven-day-streak

SQL:

WITH CTE AS (
SELECT 
USER_ID, CREATED_AT, URL, 
DENSE_RANK() OVER(PARTITION BY USER_ID, URL ORDER BY CREATED_AT ASC) AS RANKK
FROM EVENTS)

SELECT 
ROUND(COUNT(DISTINCT USER_ID)/(SELECT COUNT(DISTINCT USER_ID) FROM EVENTS), 2)
FROM CTE 
WHERE RANKK = 7


PYTHON:

