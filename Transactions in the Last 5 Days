https://www.interviewquery.com/questions/transactions-in-the-last-5-days

SQL:

WITH CTE AS 
(SELECT 
USER_ID, COUNT(DISTINCT CREATED_AT) AS CNT 
FROM BANK_TRANSACTIONS
WHERE EXTRACT(MONTH FROM CREATED_AT) = 1
AND EXTRACT(YEAR FROM CREATED_AT) = 2020
AND EXTRACT(DAY FROM CREATED_AT) IN (1, 2, 3, 4, 5)
GROUP BY 1)

SELECT 
COUNT(DISTINCT USER_ID) AS NUMBER_OF_USERS 
FROM CTE 
WHERE CNT >= 5


PYTHON:

