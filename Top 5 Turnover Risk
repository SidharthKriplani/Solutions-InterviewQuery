https://www.interviewquery.com/questions/top-5-turnover-risk

SQL:

WITH CTE AS 
(SELECT 
E.ID AS EMPLOYEE_ID, E.SALARY AS SALARY, 
P.PROJECT_ID AS PROJECT_ID, P.START_DT AS START_DT, P.END_DT AS END_DT
FROM EMPLOYEES E 
JOIN PROJECTS P 
ON E.ID = P.EMPLOYEE_ID
WHERE P.END_DT IS NOT NULL), 

FILTER_LAYER_1 AS 
(SELECT *, 
DENSE_RANK() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PROJECT_ID) AS RANKK
FROM CTE)

SELECT DISTINCT EMPLOYEE_ID 
FROM FILTER_LAYER_1
WHERE RANKK = 3


PYTHON:

