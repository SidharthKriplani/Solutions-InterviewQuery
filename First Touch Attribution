https://www.interviewquery.com/questions/first-touch-attribution

SQl:

WITH join_cte AS (
SELECT
A.session_id, A.channel, A.conversion,
US.created_at, US.user_id

FROM attribution A
JOIN user_sessions US
ON A.session_id = US.session_id),

CTE_2 AS (
SELECT channel, user_id,
DENSE_RANK() OVER(PARTITION BY user_id ORDER BY created_at) AS rankk
FROM join_cte
WHERE conversion = 1)

SELECT channel, user_id
FROM CTE_2
WHERE rankk = 1


PYTHON:

