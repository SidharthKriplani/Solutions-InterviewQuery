https://www.interviewquery.com/questions/released-patients

SQL:

WITH CTE AS (
    SELECT RELEASE_DATE, SUM(RELEASED_PATIENTS) AS TOTAL_RELEASED_PATIENTS
    FROM RELEASED_PATIENTS
    GROUP BY 1
    ORDER BY 1
), 

FILTER_LAYER_1 AS (
    SELECT 
    RELEASE_DATE, 
    TOTAL_RELEASED_PATIENTS, 
    LAG(TOTAL_RELEASED_PATIENTS, 1, 0) OVER(ORDER BY RELEASE_DATE) AS PREVIOUS_DAY_TOTAL_RELEASED_PATIENTS
    FROM CTE
)

SELECT 
RELEASE_DATE, 
TOTAL_RELEASED_PATIENTS AS RELEASED_PATIENTS
FROM FILTER_LAYER_1
WHERE TOTAL_RELEASED_PATIENTS != TOTAL_RELEASED_PATIENTS - PREVIOUS_DAY_TOTAL_RELEASED_PATIENTS
AND TOTAL_RELEASED_PATIENTS - PREVIOUS_DAY_TOTAL_RELEASED_PATIENTS > 0


PYTHON:

